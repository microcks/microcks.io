name: Spell Check

on:
  push:
    branches: [ main ]
  pull_request:

jobs:
  spell-check:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repository
        uses: actions/checkout@de0fac2e4500dabe0009e67214ff5f5447ce83dd # v6.0.2

      - name: Setup Go
        uses: actions/setup-go@7a3fe6cf4cb3a834922a1244abfce67bcef6a0c5 # v6.2.0
        with:
          go-version: '1.23'

      - name: List workspace files (debug)
        run: ls -la

      - name: Install misspell (latest)
        run: |
          go install github.com/golangci/misspell/cmd/misspell@latest
          sudo mv $(go env GOPATH)/bin/misspell /usr/local/bin/

      - name: Run misspell on Community
        run: |
          echo "Running misspell on Markdown files in content/community/ ..."
          # Read .wordlist.txt, replace newlines with commas to form a comma-separated ignore list
          IGNORE_WORDS=$(tr '\n' ',' < .wordlist.txt | sed 's/,$//')
          misspell -i "$IGNORE_WORDS" -error $(find content/community -type f -name "*.md")

      - name: Run misspell on Events
        run: |
          echo "Running misspell on Markdown files in content/events/ ..."
          # Read .wordlist.txt, replace newlines with commas to form a comma-separated ignore list
          IGNORE_WORDS=$(tr '\n' ',' < .wordlist.txt | sed 's/,$//')
          misspell -i "$IGNORE_WORDS" -error $(find content/events -type f -name "*.md")

      - name: Run misspell on Documentation
        run: |
          echo "Running misspell on Markdown files in content/documentation/ ..."
          # Read .wordlist.txt, replace newlines with commas to form a comma-separated ignore list
          IGNORE_WORDS=$(tr '\n' ',' < .wordlist.txt | sed 's/,$//')
          misspell -i "$IGNORE_WORDS" -error $(find content/documentation -type f -name "*.md")

      - name: Run misspell on Blog posts
        run: |
          echo "Running misspell on Markdown files in content/blog/ ..."
          # Read .wordlist.txt, replace newlines with commas to form a comma-separated ignore list
          IGNORE_WORDS=$(tr '\n' ',' < .wordlist.txt | sed 's/,$//')
          misspell -i "$IGNORE_WORDS" -error $(find content/blog -type f -name "*.md")

